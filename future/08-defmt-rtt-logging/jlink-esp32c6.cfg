# J-Link interface
adapter driver jlink

# JTAG transport
transport select jtag

# Slow speed for initial connection
adapter speed 100

# ESP32-C6 JTAG configuration
set _CHIPNAME esp32c6
set _CPUTAPID 0x0000dc25

# Try to be more forgiving with JTAG chain detection
jtag newtap $_CHIPNAME tap -irlen 5 -expected-id $_CPUTAPID -ignore-version

# Create the target
target create $_CHIPNAME.cpu0 riscv -chain-position $_CHIPNAME.tap

# Set reset configuration
# srst_only = use system reset only, no JTAG reset
reset_config srst_only

# Increase JTAG timeout
jtag configure $_CHIPNAME.tap -event setup {
    echo "Configuring ESP32-C6 JTAG..."
}

init
